{{ 'image-with-product.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{%- endstyle -%}

<div class="image-with-product page-width">
  <div class="image-with-product__container">
    {% render 'responsive-picture',
      desktopImage: section.settings.background_image,
      class: 'image-with-product__bg-image',
      loading: 'eager',
      cover: true
    %}

    <div class="image-with-product__content">
      <div class="image-with-product__text-content">
        <h2 class="image-with-product__heading">{{ section.settings.heading }}</h2>
        <p class="image-with-product__subheading">{{ section.settings.subheading }}</p>
        {% if section.settings.button_link %}
          <a href="{{ section.settings.button_link }}" class="image-with-product__button button">
            {{ section.settings.button_text }}
          </a>
        {% endif %}
      </div>

      {% if section.settings.featured_product %}
        {% assign product = all_products[section.settings.featured_product] %}
        <div class="image-with-product__product-card">
          {% if product.featured_image %}
            {%
              render 'responsive-picture',
              desktopImage: product.featured_image,
              mobileImage: product.featured_image,
              class: 'image-with-product__product-image',
              sizes: '80px',
              loading: 'lazy',
              alt: product.title | escape
            %}
          {% endif %}
          <div class="image-with-product__product-info">
            <h3 class="image-with-product__product-title">{{ product.title }}</h3>
            <div class="image-with-product__product-price">
              {{ product.price | money }}
              {% if product.compare_at_price > product.price %}
                <span class="image-with-product__compare-price">{{ product.compare_at_price | money }}</span>
              {% endif %}
            </div>
            <p class="image-with-product__product-description">
              Our best-selling signet ring, now on sale for a limited time!
            </p>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Image with product",
  "tag": "section",
  "class": "image-with-product-section",
  "settings": [
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image",
      "info": "Recommended size: 1920x800px"
    },
    {
      "type": "header",
      "content": "Text Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "YOUR FAVORITE, NOW ON SALE!"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Available in both 14k gold and sterling silver"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "SHOP NOW"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button Link"
    },
    {
      "type": "header",
      "content": "Product Settings"
    },
    {
      "type": "product",
      "id": "featured_product",
      "label": "Featured Product"
    }
  ],
  "presets": [
    {
      "name": "Image with product",
      "category": "Image"
    }
  ]
}
{% endschema %}
